version: 2

schedules:
  primary:
    type: pagerduty
    escalation-policy-id: P6IF4XL
  frontend:
    type: pagerduty
    schedule-id: PHZB3X0
  backend:
    type: pagerduty
    schedule-id: PPW5017

on:
  - event:
      name: schedule:changed
      schedule.ref: primary
    # Note:  This is the same as the following 'if'
    # if: $event.schedule.ref === 'primary'
    steps:
      - uses: slack/update-group
        group-id: SC9QNKU8J
        group-name: "@hero-core-auth"
        users: slackId(first($event.users))
      - uses: slack/send-message
        channel-id: GDS9MREQ0
        channel-name: "#hero-rotator-test"
        template: slack/channel/schedule-changed

  - event: schedule:changed
    if: $event.schedule.ref === 'frontend'
    steps:
      - uses: slack/update-group
        group-id: SR6RES91B
        group-name: "@core-auth-frontend"

  - event: schedule:changed
    if: $event.schedule.ref === 'backend'
    steps:
      - uses: slack/update-group
        group-id: SQYTCEQDP
        group-name: "@core-auth-backend"
